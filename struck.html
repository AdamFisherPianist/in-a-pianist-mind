<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Struck Strings – Piano Acoustics</title>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>

    body {
      font-family: "Georgia", serif;
      line-height: 1.7;
      margin: 0;
      padding: 0;
      background: #fefefe;
      color: #222;
    }
    header {
      background: #1e3a8a;
      color: white;
      padding: 30px 20px;
      text-align: center;
    }
    header h1 {
      font-size: 2.5em;
      margin: 0;
    }
    nav {
      background: #dbeafe;
      padding: 10px;
      text-align: center;
    }
    nav a {
      margin: 0 10px;
      color: #1e3a8a;
      text-decoration: none;
      font-weight: bold;
    }
    main {
      max-width: 850px;
      margin: auto;
      padding: 40px 20px;
    }
    h2 {
      color: #1e3a8a;
      margin-top: 40px;
    }
    pre {
      background: #f3f3f3;
      padding: 10px;
      font-family: monospace;
      overflow-x: auto;
    }
    figure {
      text-align: center;
      margin: 30px 0;
    }
    figcaption {
      font-size: 0.9em;
      color: #555;
    }
    footer {
      text-align: center;
      padding: 30px 10px;
      font-size: 0.9em;
      color: #777;
    }
.section-flex {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 20px;
}

.section-flex img {
  max-width: 300px;
  width: 100%;
  border-radius: 8px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.section-flex .text {
  flex: 1;
  min-width: 250px;
}
.string-section {
  display: flex;
  flex-wrap: wrap;
  gap: 30px;
  align-items: flex-start;
}

.string-text {
  flex: 1 1 60%;
  min-width: 280px;
}

.string-img {
  flex: 1 1 35%;
  min-width: 200px;
  text-align: center;
}

.string-img img {
  max-width: 100%;
  height: auto;
  border-radius: 6px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
.wrapped-img-container {
  overflow: hidden;
}

.wrapped-img {
  float: right;
  margin: 10px 0 15px 20px;
  width: 350px;
  max-width: 55%;
  border-radius: 6px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
.formula-block {
  background: #f9f9f9;
  padding: 14px 18px;
  border-left: 4px solid #ccc;
  font-size: 17px;
  margin: 25px 0;
}

.img-inline {
  display: block;
  max-width: 100%;
  height: auto;
  margin: 20px auto;
  border-radius: 6px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.08);
}

.image-row {
  display: flex;
  gap: 25px;
  flex-wrap: wrap;
  justify-content: space-between;
  margin: 30px 0;
}

.image-row img {
  flex: 1 1 45%;
  max-width: 48%;
  border-radius: 6px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.08);
}

@media (max-width: 768px) {
  .image-row img {
    max-width: 100%;
    flex: 1 1 100%;
  }
}

  </style>
</head>
<body>

<header>
  <h1>Struck Strings</h1>
  <p>Modeling the Physics of Piano Sound</p>
<p>By <a  href="about.html">Adam Erkouni El idrissi</a></p>
</header>

<nav>
  <a href="index.html">Home</a> |
  <a href="acoustics.html">Acoustics</a> |
  <a href="struck.html">Struck</a> |
  <a href="plucked.html">Plucked</a> |
  <a href="about.html">About Me</a> |  
<a href="Hammer.html" target="_blank" rel="noopener noreferrer">NEW! Nonlinear Piano Hammer</a>
</nav>

<main>

<h2>Introduction</h2>
<div class="section-flex">
  <div class="text">
    <p>
      When a player presses a piano key, a felt-covered hammer is launched toward the string. This action — fast, precise, and beautifully mechanical — produces the piano's sound. The hammer, made of compressed wool felt, behaves like a nonlinear spring during the strike.
    </p>
    <p>
      Researchers have studied this complex interaction between hammer and string using theory, experiments, and computer simulations. On this page, we take a simplified but powerful approach using the <a href="https://en.wikipedia.org/wiki/Fourier_series">Fourier Series</a> and initial conditions to explain the physics of the struck string.
    </p>
  </div>
  <img src="piano-action.gif" alt="Piano action mechanism">
</div>
<section>
  <h2>Struck vs. Plucked Strings: Boundary and Initial Conditions</h2>

  <div class="wrapped-img-container">
    <img src="string-standing-2.gif" alt="Mode Shapes of String" class="wrapped-img" />
    <p>
     The problem of the <strong>struck string</strong> is rather similar to that of the <a href="plucked.html"><strong>Plucked String</strong></a>, insofar 
as there are two types of conditions which must be considered. The <strong>Boundary Conditions</strong> (i.e. the displacement, velocity, and force values at the string ends) determine 
the possible permitted mode shapes with which the string may vibrate at one of its natural frequencies. The <strong>Initial Conditions</strong> (the initial displacement and velocity 
of the entire string at time <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>t</mi>
  <mo>=</mo>
  <mn>0</mn>
</math>
      determine which of the possible allowed modes actually contribute to the resulting motion, and with what amplitudes.
    </p>

    <p>
      For a string fixed at both ends, the boundary conditions at both ends require that the displacement 
of the string should always equal zero. This results in mode shapes where 
the transverse displacement of the string at any location on the string has been a function of a sine function:
    </p>

    <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mi>sin</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">(</mo>
  </mrow>
  <mfrac>
    <mrow>
      <mi>n</mi>
      <mi>&#x3C0;</mi>
    </mrow>
    <mi>L</mi>
  </mfrac>
  <mi>x</mi>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">)</mo>
  </mrow>
  <mtext>&#xA0;</mtext>
  <mo>,</mo>
</math>
    <p>
      where <strong>n</strong> is an integer and <strong>L</strong> is the length of the string. 
Animation at right shows the first four allowed mode shapes for a fixed-fixed string. The number 
of "humps" or antinodes is n. In setting the boundary conditions, the complete equation 
for the transverse string displacement, as a function of time and position along the string length, is:
    </p>

   <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mi>y</mi>
  <mo stretchy="false">(</mo>
  <mi>x</mi>
  <mo>,</mo>
  <mi>t</mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <munderover>
    <mo data-mjx-texclass="OP">&#x2211;</mo>
    <mrow data-mjx-texclass="ORD">
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
    </mrow>
    <mi>N</mi>
  </munderover>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.2em" maxsize="1.2em">[</mo>
  </mrow>
  <msub>
    <mi>A</mi>
    <mi>n</mi>
  </msub>
  <mi>cos</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mo stretchy="false">(</mo>
  <msub>
    <mi>&#x3C9;</mi>
    <mi>n</mi>
  </msub>
  <mi>t</mi>
  <mo stretchy="false">)</mo>
  <mo>+</mo>
  <msub>
    <mi>B</mi>
    <mi>n</mi>
  </msub>
  <mi>sin</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mo stretchy="false">(</mo>
  <msub>
    <mi>&#x3C9;</mi>
    <mi>n</mi>
  </msub>
  <mi>t</mi>
  <mo stretchy="false">)</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.2em" maxsize="1.2em">]</mo>
  </mrow>
  <mi>sin</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">(</mo>
  </mrow>
  <mfrac>
    <mrow>
      <mi>n</mi>
      <mi>&#x3C0;</mi>
    </mrow>
    <mi>L</mi>
  </mfrac>
  <mi>x</mi>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">)</mo>
  </mrow>
</math>
    <p>
     where <strong>ωₙ</strong> is the natural frequency of the nth mode, and the coefficients <strong>Aₙ </strong> 
and <strong>Bₙ </strong> are determined from the initial displacement and velocity of the string. The string 
has a linear density ρ<sub>L</sub> [kg/m] and is stretched to tension <strong>T</strong>; transverse waves 
travel along the string with a speed <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>c</mi>
  <mo>=</mo>
  <msqrt>
    <mi>T</mi>
    <mrow data-mjx-texclass="ORD">
      <mo>/</mo>
    </mrow>
    <msub>
      <mi>&#x3C1;</mi>
      <mi>L</mi>
    </msub>
  </msqrt>
</math>.
     The natural frequencies of the permitted mode shapes vary with the string length and speed of the wave:
    </p>

   <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <msub>
    <mi>&#x3C9;</mi>
    <mi>n</mi>
  </msub>
  <mo>=</mo>
  <mn>2</mn>
  <mi>&#x3C0;</mi>
  <mstyle scriptlevel="0">
    <mspace width="0.167em"></mspace>
  </mstyle>
  <mfrac>
    <mrow>
      <mi>n</mi>
      <mi>c</mi>
    </mrow>
    <mrow>
      <mn>2</mn>
      <mi>L</mi>
    </mrow>
  </mfrac>
  <mtext>&#xA0;</mtext>
  <mo>.</mo>
</math>

    <p>
      The natural frequencies will be higher if the string is shorter, or if the tension is higher, 
      or if the density is lower. The natural (or permitted) frequencies are integer multiples of the fundamental 
      (n = 1) frequency.
    </p>
  </div>
</section>



  <section>
  <h2>Initial Conditions for the Struck String</h2>

  <p>
    The actual interaction between the piano hammer and string is a complex one, but we can get a useful approximation by assuming the string starts at rest, and a short segment is given an initial velocity. The Fourier Coefficients \( A_n \) and \( B_n \) describe how different vibrational modes contribute to the motion. They are derived from the string’s initial displacement \( y(x,0) \) and velocity \( u(x,0) \):
  </p>

  <div class="formula-block">
    \[
    A_n = \frac{2}{L} \int_0^L y(x,0) \sin\left( \frac{n \pi x}{L} \right) dx, \quad 
    B_n = \frac{2}{\omega_n L} \int_0^L u(x,0) \sin\left( \frac{n \pi x}{L} \right) dx
    \]
  </div>

  <p>
    Since the struck string is initially at rest at equilibrium, all of the \( A_n \) terms are zero. The \( B_n \) coefficients depend on the velocity profile imparted by the hammer.
  </p>

  <img src="initial-velocity-1.jpg" alt="Impulse region diagram" class="img-inline" />

  <blockquote>
    As a first approximation, let’s assume a uniform velocity \( v_0 \) is applied between \( \alpha_1 L \) and \( \alpha_2 L \), and zero elsewhere. This leads to:
  </blockquote>

  <div class="formula-block">
    \[
    B_n = \frac{2 v_0 L}{c (\pi n)^2} \left( \cos(\alpha_1 \pi n) - \cos(\alpha_2 \pi n) \right)
    \]
  </div>

  <p>
    The full displacement of the string over time can then be expressed as:
  </p>

  <div class="formula-block">
    \[
    y(x,t) = \sum_{n=1}^{N} B_n \sin\left( \frac{n \pi x}{L} \right) \sin\left( \frac{2 \pi n c}{2L} t \right)
    \]
  </div>

  <div class="image-row">
    <img src="struck-build-1.gif" alt="Five-term Fourier approximation" />

    <img src="velocity-profile-2.gif" alt="Fifty-six-term Fourier approximation" />
<figcaption>Animations:<a href="https://www.acs.psu.edu/drussell/demos.html">Dan Russel</a></figcaption>
  </div>

  <p>
    The plots above show how a Fourier sum of a few sine waves can already model string behavior right after the hammer strike. A more realistic model uses a half-sine-shaped initial velocity. Though analytically harder to solve, it produces sharper pulses.
  </p>

  <img src="struck-build-2.gif" alt="Fourier buildup animation" class="img-inline" />

  <p>
    It’s remarkable how a sum of sine waves with the right amplitude and frequency can reconstruct such rich physical behavior. This is the core of how musical acoustics connects mathematics, physics, and sound.
  </p>
</section>


  <h2>Striking vs. Plucking</h2>
  <p>
    In plucked strings (like a guitar), the string starts with an initial displacement but zero velocity. In contrast, a struck string begins with an initial velocity and zero displacement.
  </p>

  <h2>Mode Shapes and Harmonic Content</h2>
  <p>
    Below is a diagram of the first few standing wave modes (n = 1, 2, 3...) of a vibrating string. These combine linearly to form the total vibration.
  </p>

  <figure>
    <img src="mode-shapes-placeholder.png" alt="Mode Shapes" width="60%" />
    <figcaption><a href="https://www.physicsbootcamp.org/normal-modes-of-a-string.html">Source: physicsbootcamp</a>
Mode shapes for the first few harmonics of a string.</figcaption>
  </figure>

  <p>
    In a real piano, the hammer doesn’t strike exactly in the middle — typically around 1/7 of the string length. This avoids exciting only odd harmonics (as a center strike would).
  </p>

  <h2>Time-Domain Vibration</h2>
  <p>
    Here's a simulation of a waveform built from the first six harmonics of A2, assuming a struck-string distribution:
  </p>

  <figure>
    <img src="piano-vibration-waveform.png" alt="Struck string waveform" width="100%" />
    <figcaption>Waveform built from A2 + its first harmonics (struck configuration).</figcaption>
  </figure>

  <h2>Spectrum</h2>
  <p>
    The frequency domain view shows distinct peaks at the fundamental and overtones. All harmonics are present and gradually decrease in amplitude.
  </p>

  <figure>
    <img src="piano-spectrum.png" alt="Frequency spectrum" width="100%" />
    <figcaption>Spectrum of a struck A2 string: fundamental + overtones.</figcaption>
  </figure>

  <h2>Conclusion</h2>
  <p>
    The physics of struck strings shows how energy delivery changes everything. Unlike bowed or plucked instruments, the piano's hammer activates a unique blend of harmonics, giving it its distinctive sound. By modeling the strike with a velocity function and solving the Fourier series, we can predict the sound — or even design it.
  </p>

</main>

<footer>
  Created by Adam Erkouni El Idrissi · Based on acoustic modeling resources by D. Russell
</footer>

</body>
</html>

