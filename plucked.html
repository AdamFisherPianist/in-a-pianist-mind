<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Struck Strings – Piano Acoustics</title>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>

    body {
      font-family: "Georgia", serif;
      line-height: 1.7;
      margin: 0;
      padding: 0;
      background: #fefefe;
      color: #222;
    }
    header {
      background: #1e3a8a;
      color: white;
      padding: 30px 20px;
      text-align: center;
    }
    header h1 {
      font-size: 2.5em;
      margin: 0;
    }
    nav {
      background: #dbeafe;
      padding: 10px;
      text-align: center;
    }
    nav a {
      margin: 0 10px;
      color: #1e3a8a;
      text-decoration: none;
      font-weight: bold;
    }
    main {
      max-width: 850px;
      margin: auto;
      padding: 40px 20px;
    }
    h2 {
      color: #1e3a8a;
      margin-top: 40px;
    }
    pre {
      background: #f3f3f3;
      padding: 10px;
      font-family: monospace;
      overflow-x: auto;
    }
    figure {
      text-align: center;
      margin: 30px 0;
    }
    figcaption {
      font-size: 0.9em;
      color: #555;
    }
    footer {
      text-align: center;
      padding: 30px 10px;
      font-size: 0.9em;
      color: #777;
    }
.section-flex {
  display: flex;
  flex-wrap: wrap;
  align-items: center;
  gap: 20px;
}

.section-flex img {
  max-width: 300px;
  width: 100%;
  border-radius: 8px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.section-flex .text {
  flex: 1;
  min-width: 250px;
}
.string-section {
  display: flex;
  flex-wrap: wrap;
  gap: 30px;
  align-items: flex-start;
}

.string-text {
  flex: 1 1 60%;
  min-width: 280px;
}

.string-img {
  flex: 1 1 35%;
  min-width: 200px;
  text-align: center;
}

.string-img img {
  max-width: 100%;
  height: auto;
  border-radius: 6px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
.wrapped-img-container {
  overflow: hidden;
}

.wrapped-img {
  float: right;
  margin: 10px 0 15px 20px;
  width: 350px;
  max-width: 55%;
  border-radius: 6px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}
.formula-block {
  background: #f9f9f9;
  padding: 14px 18px;
  border-left: 4px solid #ccc;
  font-size: 17px;
  margin: 25px 0;
}

.img-inline {
  display: block;
  max-width: 100%;
  height: auto;
  margin: 20px auto;
  border-radius: 6px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.08);
}

.image-row {
  display: flex;
  gap: 25px;
  flex-wrap: wrap;
  justify-content: space-between;
  margin: 30px 0;
}

.image-row img {
  flex: 1 1 45%;
  max-width: 48%;
  border-radius: 6px;
  box-shadow: 0 4px 8px rgba(0,0,0,0.08);
}

@media (max-width: 768px) {
  .image-row img {
    max-width: 100%;
    flex: 1 1 100%;
  }
}

  </style>
</head>
<body>

<header>
  <h1>Struck Strings</h1>
  <p>Modeling the Physics of Piano Sound</p>
<p>By <a  href="about.html">Adam Erkouni El idrissi</a></p>
</header>

<nav>
  <a href="index.html">Home</a> |
  <a href="acoustics.html">Acoustics</a> |
  <a href="struck.html">Struck</a> |
  <a href="plucked.html">Plucked</a> |
  <a href="about.html">About Me</a> |  
<a href="path/to/Hammer.html" target="_blank" rel="noopener noreferrer">NEW! Nonlinear Piano Hammer</a>
</nav>

<main>

<h2>Plucked Strings: Boundary and Initial Conditions</h2>
<div class="wrapped-img-container">
    <img src="string-standing-2.gif" alt="Mode Shapes of String" class="wrapped-img" />
    <p>
    When solving the problem of a <strong>plucked string</strong>, fixed at both ends, there are two types of conditions which must be considered. The <strong>Boundary Conditions</strong> (ie, the values of displacement, velocity, and force at the each end of the string) determine the possible allowed mode shapes with which the string may vibrate at one of its natural frequencies. The <strong>Initial Conditions</strong> (the initial displacement and velocity of the entire string at time  <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>t</mi>
  <mo>=</mo>
  <mn>0</mn>
</math>
      determine which of the possible allowed modes actually contribute to the resulting motion, and with what amplitudes.
    </p>

    <p>
      For a string fixed at both ends, the boundary conditions at both ends require that the displacement 
of the string should always equal zero. This results in mode shapes where 
the transverse displacement of the string at any location on the string has been a function of a sine function:
    </p>

    <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mi>sin</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">(</mo>
  </mrow>
  <mfrac>
    <mrow>
      <mi>n</mi>
      <mi>&#x3C0;</mi>
    </mrow>
    <mi>L</mi>
  </mfrac>
  <mi>x</mi>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">)</mo>
  </mrow>
  <mtext>&#xA0;</mtext>
  <mo>,</mo>
</math>
    <p>
      where <strong>n</strong> is an integer and <strong>L</strong> is the length of the string. 
Animation at right shows the first four allowed mode shapes for a fixed-fixed string. The number 
of "humps" or antinodes is n. In setting the boundary conditions, the complete equation 
for the transverse string displacement, as a function of time and position along the string length, is:
    </p>

   <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mi>y</mi>
  <mo stretchy="false">(</mo>
  <mi>x</mi>
  <mo>,</mo>
  <mi>t</mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <munderover>
    <mo data-mjx-texclass="OP">&#x2211;</mo>
    <mrow data-mjx-texclass="ORD">
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
    </mrow>
    <mi>N</mi>
  </munderover>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.2em" maxsize="1.2em">[</mo>
  </mrow>
  <msub>
    <mi>A</mi>
    <mi>n</mi>
  </msub>
  <mi>cos</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mo stretchy="false">(</mo>
  <msub>
    <mi>&#x3C9;</mi>
    <mi>n</mi>
  </msub>
  <mi>t</mi>
  <mo stretchy="false">)</mo>
  <mo>+</mo>
  <msub>
    <mi>B</mi>
    <mi>n</mi>
  </msub>
  <mi>sin</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mo stretchy="false">(</mo>
  <msub>
    <mi>&#x3C9;</mi>
    <mi>n</mi>
  </msub>
  <mi>t</mi>
  <mo stretchy="false">)</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.2em" maxsize="1.2em">]</mo>
  </mrow>
  <mi>sin</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">(</mo>
  </mrow>
  <mfrac>
    <mrow>
      <mi>n</mi>
      <mi>&#x3C0;</mi>
    </mrow>
    <mi>L</mi>
  </mfrac>
  <mi>x</mi>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">)</mo>
  </mrow>
</math>
    <p>
     where <strong>ωₙ</strong> is the natural frequency of the nth mode, and the coefficients <strong>Aₙ </strong> 
and <strong>Bₙ </strong> are determined from the initial displacement and velocity of the string. The string 
has a linear density ρ<sub>L</sub> [kg/m] and is stretched to tension <strong>T</strong>; transverse waves 
travel along the string with a speed <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>c</mi>
  <mo>=</mo>
  <msqrt>
    <mi>T</mi>
    <mrow data-mjx-texclass="ORD">
      <mo>/</mo>
    </mrow>
    <msub>
      <mi>&#x3C1;</mi>
      <mi>L</mi>
    </msub>
  </msqrt>
</math>.
     The natural frequencies of the permitted mode shapes vary with the string length and speed of the wave:
    </p>

   <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <msub>
    <mi>&#x3C9;</mi>
    <mi>n</mi>
  </msub>
  <mo>=</mo>
  <mn>2</mn>
  <mi>&#x3C0;</mi>
  <mstyle scriptlevel="0">
    <mspace width="0.167em"></mspace>
  </mstyle>
  <mfrac>
    <mrow>
      <mi>n</mi>
      <mi>c</mi>
    </mrow>
    <mrow>
      <mn>2</mn>
      <mi>L</mi>
    </mrow>
  </mfrac>
  <mtext>&#xA0;</mtext>
  <mo>.</mo>
</math>

    <p>
      The natural frequencies will be higher if the string is shorter, or if the tension is higher, 
      or if the density is lower. The natural (or permitted) frequencies are integer multiples of the fundamental 
      (n = 1) frequency.
    </p>
  </div>
</section>


  <section>
  <h2>Initial Conditions for the Plucked String</h2>

  <p>
In order to determine values for the coefficients  <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub>
    <mi>A</mi>
    <mi>n</mi>
  </msub>
</math>
and<math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub>
    <mi>B</mi>
    <mi>n</mi>
  </msub>
</math>
we need to know the initial shape of the string at time<math xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>t</mi>
  <mo>=</mo>
  <mn>0</mn>
</math>
.
These coefficients (called Fourier coefficients) are determined from the initial displacement and the initial velocity of the string, with <math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub>
    <mi>A</mi>
    <mi>n</mi>
  </msub>
</math>
coming from the initial displacement and<math xmlns="http://www.w3.org/1998/Math/MathML">
  <msub>
    <mi>B</mi>
    <mi>n</mi>
  </msub>
</math>
from the initial velocity,
  </p>

  <div class="formula-block">
    \[
    A_n = \frac{2}{L} \int_0^L y(x,0) \sin\left( \frac{n \pi x}{L} \right) dx, \quad 
    B_n = \frac{2}{\omega_n L} \int_0^L u(x,0) \sin\left( \frac{n \pi x}{L} \right) dx
    \]
  </div>

  <p>
    When a string is plucked, it is pulled aside to a transverse distance \(h\) at a distance \(d\) from one end, and then released from rest. The initial shape of the string will be triangular comprised of two straight line segments.
  </p>

  <img src="distances.jpg"  class="img-inline" />

  <p>
    Since the plucked string is initially released from rest, the initial velocity is zero, and therefore all of the \( B_n =0\). To get the values of the \( A_n \) you need a math expression for the initial displacement (two straight lines).

  </p>

  <div class="formula-block">
    <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mi>y</mi>
  <mo stretchy="false">(</mo>
  <mi>x</mi>
  <mo>,</mo>
  <mi>n</mi>
  <mo>=</mo>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <mrow data-mjx-texclass="INNER">
    <mo data-mjx-texclass="OPEN">{</mo>
    <mtable columnalign="left left" columnspacing="1em" rowspacing=".2em">
      <mtr>
        <mtd>
          <mi>h</mi>
          <mfrac>
            <mi>x</mi>
            <mi>d</mi>
          </mfrac>
          <mstyle scriptlevel="0">
            <mspace width="2em"></mspace>
          </mstyle>
          <mtext>for</mtext>
          <mstyle scriptlevel="0">
            <mspace width="1em"></mspace>
          </mstyle>
          <mn>0</mn>
          <mo>&#x2264;</mo>
          <mi>x</mi>
          <mo>&#x2264;</mo>
          <mi>d</mi>
          <mo>,</mo>
        </mtd>
      </mtr>
      <mtr>
        <mtd>
          <mi>h</mi>
          <mfrac>
            <mrow>
              <mi>L</mi>
              <mo>&#x2212;</mo>
              <mi>x</mi>
            </mrow>
            <mrow>
              <mi>L</mi>
              <mo>&#x2212;</mo>
              <mi>d</mi>
            </mrow>
          </mfrac>
          <mstyle scriptlevel="0">
            <mspace width="2em"></mspace>
          </mstyle>
          <mtext>for</mtext>
          <mstyle scriptlevel="0">
            <mspace width="1em"></mspace>
          </mstyle>
          <mi>d</mi>
          <mo>&#x2264;</mo>
          <mi>x</mi>
          <mo>&#x2264;</mo>
          <mi>L</mi>
        </mtd>
      </mtr>
    </mtable>
    <mo data-mjx-texclass="CLOSE" fence="true" stretchy="true" symmetric="true"></mo>
  </mrow>
</math>
  </div>

  <p>
    and then you have to carry out two integrals for \(A_n\)
, (one for each segment of \(x\)), which yields the result
 
  </p>

  <div class="formula-block">
   <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <msub>
    <mi>A</mi>
    <mi>n</mi>
  </msub>
  <mo>=</mo>
  <mfrac>
    <mrow>
      <mn>2</mn>
      <mi>h</mi>
    </mrow>
    <mrow>
      <msup>
        <mi>n</mi>
        <mn>2</mn>
      </msup>
      <msup>
        <mi>&#x3C0;</mi>
        <mn>2</mn>
      </msup>
    </mrow>
  </mfrac>
  <mfrac>
    <msup>
      <mi>L</mi>
      <mn>2</mn>
    </msup>
    <mrow>
      <mi>d</mi>
      <mo stretchy="false">(</mo>
      <mi>L</mi>
      <mo>&#x2212;</mo>
      <mi>d</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </mfrac>
  <mstyle scriptlevel="0">
    <mspace width="0.167em"></mspace>
  </mstyle>
  <mi>sin</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">(</mo>
  </mrow>
  <mfrac>
    <mrow>
      <mi>d</mi>
      <mi>n</mi>
      <mi>&#x3C0;</mi>
    </mrow>
    <mi>L</mi>
  </mfrac>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">)</mo>
  </mrow>
</math>
  </div>
<p>
    NOTE: if you use a different math expression for the straight line segments to describe the initial displacement, the resulting expression for \(A_n\)  will look different, but the behavior of the string will be the same. Looking at expression for  \(A_n\), we can see that the fundamental (n=1)
 has the largest amplitude, and all higher values of 
 have much smaller amplitudes. Because of the <math xmlns="http://www.w3.org/1998/Math/MathML">
  <mi>sin</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.2em" maxsize="1.2em">(</mo>
  </mrow>
  <mfrac>
    <mrow>
      <mi>d</mi>
      <mi>n</mi>
      <mi>&#x3C0;</mi>
    </mrow>
    <mi>L</mi>
  </mfrac>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.2em" maxsize="1.2em">)</mo>
  </mrow>
</math>
 
 term, the coefficients \(A_n\)
 will be zero when n
 is an integer multiple of \(L/d\)
. This means that for a string plucked at a point 1/3 of its length from the end (so that \(d=L/3\)
) all of coefficients \(A_3\), \(A_6\), \(A_9\), etc
, etc. will be zero and sill be missing from the total sum. Once the coefficients \(A_n\)
 and \(B_n\)
 are known, we can use them to reconstruct the initial shape the string. For the plucked string, with \(B_n=0\ )
 and the \(A_n\
 from the expression above, we have
  </p>

  <div class="formula-block">
   <math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mi>y</mi>
  <mo stretchy="false">(</mo>
  <mi>x</mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <munderover>
    <mo data-mjx-texclass="OP">&#x2211;</mo>
    <mrow data-mjx-texclass="ORD">
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
    </mrow>
    <mi>N</mi>
  </munderover>
  <msub>
    <mi>A</mi>
    <mi>n</mi>
  </msub>
  <mi>sin</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">(</mo>
  </mrow>
  <mfrac>
    <mrow>
      <mi>n</mi>
      <mi>&#x3C0;</mi>
    </mrow>
    <mi>L</mi>
  </mfrac>
  <mi>x</mi>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">)</mo>
  </mrow>
  <mtext>&#xA0;</mtext>
  <mo>.</mo>
</math>
  </div>
<p>
The animation below shows how, as each successive mode n
 is added to the sum, the shape of the sum of the individual allowed mode shapes begins to look more and more like the initial plucked displacement of the string.
</p>

  <div class="image-row">
    <img src="build-pluck.gif" />
  </div>


  <h2>Motion of the Plucked String</h2>
  <p>
   The complete Fourier Series expression for the motion of the plucked string is then
  </p>
  <div class="formula-block">
<math xmlns="http://www.w3.org/1998/Math/MathML" display="block">
  <mi>y</mi>
  <mo stretchy="false">(</mo>
  <mi>x</mi>
  <mo>,</mo>
  <mi>t</mi>
  <mo stretchy="false">)</mo>
  <mo>=</mo>
  <munderover>
    <mo data-mjx-texclass="OP">&#x2211;</mo>
    <mrow data-mjx-texclass="ORD">
      <mi>n</mi>
      <mo>=</mo>
      <mn>1</mn>
    </mrow>
    <mi>N</mi>
  </munderover>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">[</mo>
  </mrow>
  <mfrac>
    <mrow>
      <mn>2</mn>
      <mi>h</mi>
    </mrow>
    <mrow>
      <msup>
        <mi>n</mi>
        <mn>2</mn>
      </msup>
      <msup>
        <mi>&#x3C0;</mi>
        <mn>2</mn>
      </msup>
    </mrow>
  </mfrac>
  <mfrac>
    <msup>
      <mi>L</mi>
      <mn>2</mn>
    </msup>
    <mrow>
      <mi>d</mi>
      <mo stretchy="false">(</mo>
      <mi>L</mi>
      <mo>&#x2212;</mo>
      <mi>d</mi>
      <mo stretchy="false">)</mo>
    </mrow>
  </mfrac>
  <mstyle scriptlevel="0">
    <mspace width="0.167em"></mspace>
  </mstyle>
  <mi>sin</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">(</mo>
  </mrow>
  <mfrac>
    <mrow>
      <mi>d</mi>
      <mi>n</mi>
      <mi>&#x3C0;</mi>
    </mrow>
    <mi>L</mi>
  </mfrac>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">)</mo>
  </mrow>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">]</mo>
  </mrow>
  <mtext>&#xA0;</mtext>
  <mi>sin</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">(</mo>
  </mrow>
  <mfrac>
    <mrow>
      <mi>n</mi>
      <mi>&#x3C0;</mi>
    </mrow>
    <mi>L</mi>
  </mfrac>
  <mi>x</mi>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">)</mo>
  </mrow>
  <mi>cos</mi>
  <mo data-mjx-texclass="NONE">&#x2061;</mo>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">(</mo>
  </mrow>
  <mn>2</mn>
  <mi>&#x3C0;</mi>
  <mfrac>
    <mrow>
      <mi>n</mi>
      <mi>c</mi>
    </mrow>
    <mrow>
      <mn>2</mn>
      <mi>L</mi>
    </mrow>
  </mfrac>
  <mi>t</mi>
  <mrow data-mjx-texclass="ORD">
    <mo minsize="1.623em" maxsize="1.623em">)</mo>
  </mrow>
  <mtext>&#xA0;</mtext>
  <mo>.</mo>
</math>
</div>
<p>
When the string is released from rest, each of the allowed modes begins oscillate at its own individual natural frequency, with the result that the sum changes with time as the individual modes combine together. This is illustrated in the animation below, where the thick black curve represents the actual string (the sum of all of the individual modes) and the colors represent the individual modes each oscillating at their own natural frequencies and with their own maximum amplitudes. The frequency associated with the total (sum) string motion is the same as the frequency of the fundamental mode; a guitar string tuned to 384Hz will undergo one complete back and forth motion 384 times every second.

</p>
<div class="image-row">
    <img src="sum-motion.gif" />
  </div>
  <figcaption>The resulting motion of a string plucked at a different point may be obtained by changing the pluck point \(d\)
 and recalculating the sum.</a>

</main>

<footer>
  Created by Adam Erkouni El Idrissi · Based on acoustic modeling resources by D. Russell
</footer>

</body>
</html>
